Компоненты
==========
**Компонент** — это отдельная, абстрагированная сущность, с определенным API (который задается в конфиге компонента) которая может содержать любой набор ассетов (css, js, tpl, images и т.д.) и без проблем использоваться в различных проектах.

## Структура компонента
Фиксированная структура:

| Объект | Описание |
| :-- | :-- |
| `/tests`         | Тесты (visual, js) |
| `/docs`          | Документация |
| `component.json` | Конфиг |
| `README.md`      | Краткое описание компонента |

Остальные файлы (css, js, шаблоны, изображения, шрифты и т.д.) размещаются в любых папках, путь до них указывается в конфиге компонента. При подключении компонента пути до ассетов (css, js, tpl) берутся из конфига компонента.

## Конфиг

Конфиг компонента находится в файле `component.json`.

~~~js
// Уникальное название компонента
"name": "alert",

// Описание компонента
// Если текущего языка нету в списке, то берется первый из списка
"description": {
    "en": "Alerts",
    "ru": "Уведомления"
},

// Версия
"version": "1.0.0",

// Дата последнего релиза в формате DD-MM-YYYY
"date": "01-01-2014",

// Автор
"author": "John Doe <john.doe@gmail.com>",

// Git репозиторий
"repo": "https://github.com/johndoe/alert",

// Зависимости
//
// Список компонентов необходимых для работы текущего компонента
// Ассеты указанных компонентов будут подключены раньше ассетов текущего компонента
"dependencies": {
    "ls-core": "*",
    "icons": "1.0.0"
},

// Шаблоны
//
// Сначало указывается уникальное имя шаблона, а потом путь
// (относительно папки с компонентом) до него.
// При подключении компонента в параметре template надо указывать именно уникальное имя,
// а не путь до шаблона, например:
// {component 'field' template='mytemplate'}
"templates": {
    "alert": "templates/alert.tpl",
    "mytemplate": "templates/blocks/someblock.tpl"
},

// Стили
"styles": {
    "alert": "css/alert.css",
    "info": "css/alert-info.css"
},

// RTL стили
"styles-rtl": {
    "alert": "css/alert-rtl.css"
},

// Скрипты
"scripts": {
    "alert": "js/alert.js"
},
~~~

## Размещение

* Базовые компоненты фреймворка  
`/framework/frontend/components`

* Компоненты приложения
    * Общие для всех шаблонов компоненты определенного приложения  
    *Переопределяют компоненты фреймворка*  
    `/_myapp_/frontend/components`

    * Компоненты шаблона  
    *Переопределяют общие компоненты приложения*  
    `/_myapp_/frontend/templates/_mytemplate_/components`

* Компоненты плагинов
    * Общие компоненты плагина используемые его шаблонами  
    *Переопределяют общие компоненты приложения*  
    `/_myapp_/plugins/_myplugin_/frontend/components`

    * Компоненты шаблона плагина  
    *Переопределяют общие компоненты плагина*  
    `/_myapp_/plugins/_myplugin_/frontend/templates/_mytemplate_/components`


## Подключение

Подключаемые компоненты указываются в спец. параметре конфига движка, при этом подключаются так же и все зависимые компоненты даже если они явно не указаны:
~~~php
$config['components'] = [ 'ls-core', 'alert' ];
~~~

### Использование в шаблонах
Для подключения компонентов используется smarty функция `component`.

Зарезервированные параметры:

| Параметр | Описание |
| :-- | :-- |
| `component` | Название компонента, дефолтный параметр |
| `template` | Подключаемый файл (шаблон), указывается без расширения, по умолчанию равен названию компонента |
| `params` | Принимает параметры в виде массива (переопределяются параметрами заданными обычным путем) |
| `assign` | Аналогично параметру assign у include'а |

Подключение конкретного файла из компонента, путь до файла указывается в параметре template:
~~~smarty
{* Подключится файл /_myapp_/frontend/templates/_mytemplate_/components/mycomponent/blocks/myblock.tpl *}
{* Если в шаблоне компонента нет, то он ищется в папке /_myapp_/frontend/components/ *}
{* Если его и там нет, то он ищется во фреймворке /_myapp_/frontend/components/ *}
{component 'mycomponent' template='blocks/myblock' text='Some text'}
~~~

Если параметр template не указан, подключается шаблон совпадающий с именем компонента:
~~~smarty
{* Подключится файл {components}/alert/alert.tpl *}
{component 'alert' title='Warning' text='Some error message' mods='error'}
~~~

#### Использование в плагинах

По умолчанию подключается компонент из шаблона приложения:
~~~smarty
{* Подключится файл /_myapp_/frontend/templates/_mytemplate_/components/alert/alert.tpl *}
{component 'alert' text='Some text'}
~~~

Для подключения компонента определенного в плагине используется префикс `plugin:` добавляемый к названию компонента:
~~~smarty
{* Подключится файл /_myapp_/plugins/_myplugin_/frontend/templates/_mytemplate_/components/alert/alert.tpl *}
{* Если в шаблоне плагина компонента нет, то он ищется в папке /_myapp_/plugins/_myplugin_/frontend/components/ *}
{* Если его и там нет, то он затем ищется в приложении (/_myapp_/frontend/components/) и фреймворке *}
{component 'plugin:alert' text='Some text'}
~~~


[Источник](https://github.com/livestreet/livestreet/wiki/%D0%9A%D0%BE%D0%BC%D0%BF%D0%BE%D0%BD%D0%B5%D0%BD%D1%82%D1%8B)